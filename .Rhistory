setwd("C:/Users/BATMAN/Desktop/project 2 edwisor")
# Load train data
df =  read.csv("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xlsx("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
View(df)
install.packages("xlsx")
library("xlsx", lib.loc="~/R/win-library/3.4")
library("xlsx")
library("xlsx")
library("xlsx", lib.loc="~/R/win-library/3.4")
# Load train data
df =  read.xlsx("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xls("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
install.packages("xlsx")
library("xlsx")
library("xlsxjars", lib.loc="~/R/win-library/3.4")
library("xlsx", lib.loc="~/R/win-library/3.4")
# Load train data
df =  read.xls("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xlsx("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xlsx2("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
library("xlsx")
install.packages("xlsx")
library("xlsx")
# Load train data
df =  read.xlsx2("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xlsx("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xlsx("Absenteeism_at_work_Project.xls")
df = read.xlsx("Absenteeism_at_work_Project.xlsx", sheetName="")
setwd("C:/Users/BATMAN/Desktop/project 2 edwisor")
df = read.xlsx("Absenteeism_at_work_Project.xls", sheetName="")
# Load train data
df =  read.xls("Absenteeism_at_work_Project.xls")
# Load train data
df =  read.xls("Absenteeism_at_work_Project.xlsx")
# Load train data
df =  read.xls("Absenteeism_at_work_Project.xlsx")
df = read.xlsx("Absenteeism_at_work_Project.xls", sheetName="")
# Load train data
df =  read.xls("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xlsx")
rm(list=ls())
setwd("C:/Users/BATMAN/Desktop/project 2 edwisor")
getwd()
install.packages("xlsx")
install.packages("xlsx")
library("xlsx")
# Load train data
df =  read.xls("C:/Users/BATMAN/Desktop/project 2 edwisor/Absenteeism_at_work_Project.xlsx")
df = read.xlsx("Absenteeism_at_work_Project.xls", sheetName="")
df = read.xlsx("Absenteeism_at_work_Project.xls", sheetName="")
df = read.xls("Absenteeism_at_work_Project.xls", sheetName="")
df = read.xlsx2("Absenteeism_at_work_Project.xls", sheetName="")
install.packages("tidyverse")
install.packages("readxl")
library(readxl)
read_excel("Absenteeism_at_work_Project.xls")
# Load train data
df =  read_excel("Absenteeism_at_work_Project.xls")
View(df)
View(df)
df1 = df
#Check missing vales
sum(is.na(df))
#Check missing vales
sum(is.na(df$ID))
sum(is.na(df))
sum(is.na(df))
sum(is.na(df))
sum(is.na(df))
sum(is.na(df))
#Check missing vales
sum(is.na(df$ID))
sum(is.na(df$`Reason for absence`))
sum(is.na(df$`Month of absence`))
sum(is.na(df$`Day of the week`))
sum(is.na(df$Seasons))
sum(is.na(df$`Transportation expense`))
sum(is.na(df$`Distance from Residence to Work`))
sum(is.na(df$`Service time`))
sum(is.na(df$Age))
sum(is.na(df$`Work load Average/day`))
sum(is.na(df$`Hit target`))
sum(is.na(df$`Disciplinary failure`))
sum(is.na(df$Education))
sum(is.na(df$Son))
sum(is.na(df$`Social drinker`))
sum(is.na(df$`Social smoker`))
sum(is.na(df$Pet))
sum(is.na(df$Weight))
sum(is.na(df$Height))
sum(is.na(df$`Body mass index`))
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
View(missing_val)
View(missing_val)
View(df)
View(df)
#Numeric variables
num_var = ['a','b']
#Numeric variables
num_var = ('a','b')
#Numeric variables
num_var = -c('a','b')
View(df)
View(df)
#Numeric variables
numeric_data <- subset(df, select = c(ID,Transportation.expense)
#Numeric variables
numeric_data <- subset(df, select = c(ID,Transportation.expense))
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation.expense'))
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense'))
View(numeric_data)
View(numeric_data)
View(df)
View(df)
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))))
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours')))
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
View(numeric_data)
View(numeric_data)
num_var = colnames(numeric_data)
#Categorical variavles
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day ','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
#Categorical variavles
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day ','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
# Load train data
df =  read_excel("Absenteeism_at_work_Project.xls")
df1 = df
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
num_var = colnames(numeric_data)
#Categorical variavles
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day ','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
#Categorical variavles
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
View(category_data)
View(category_data)
#All features/variables
var = colnames(df)
for(i in num_var)
{
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,i][df[,i] %in% val] = NA
}
df[,ID]
df[,'ID']
for(i in num_var)
{
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,i][df[,i] %in% val] = NA
}
View(df)
View(df)
num_var
print('1')
print('i')
print(i)
print(i)
for(i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,i][df[,i] %in% val] = NA
}
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,'ID']
df[,'ID'][df[,'ID'] %in% boxplot.stats(df[,'ID']$out)]
num_var
print(i)
for (i in 2010:2015){
print(paste("The year is", i))
}
for (i in num_var){
print(paste("The year is", i))
}
for (i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
print(i)
(paste("The year is",
for (i in num_var){
print(paste("The year is", i))
}
for (i in num_var){
print(paste("The year is", i))
}
print(paste("The year is", i))
print(paste("The year is", i))
for (i in 2010:2015){
print(paste("The year is", i))
}
for (i in num_var){
print(paste("The year is", i))
}
print('1')
"paste("The year is", i)"
for(i in num_var){
print(i)
}
for (i in num_var){
print('1')
}
for (i in num_var){
print(i)
}
for (i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
for (i in num_var){
print(i)
}
val = df[,i]
for (i in num_var){
print(i)
val = df[,i]
}
for (i in num_var){
print(i)
val = df[,i][df[,i] ]
}
for (i in num_var){
print(i)
val = df[,i][df[,i]]
}
for (i in num_var){
print(i)
val = df[,i]df[,i]
}
for (i in num_var){
print(i)
val = df[,i]df[,i]
}
for (i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
for (i in num_var){
print(i)
val = df$i[df$i %in% boxplot.stats(df$i)$out]
}
for (i in num_var){
print(df$i)
}
for (i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
val = df$Seasons[df$Seasons %in% boxplot.stats(df$Seasons)$out]
View(df)
val = df$Seasons[df$Seasons %in% boxplot.stats(df$Seasons)$out]
val = df$Seasons[df$Seasons %in% boxplot.stats(df$Seasons)$out]
df = df[which(!df$Seasons %in% val),]
View(missing_val)
View(missing_val)
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df = df[which(!df$`Transportation expense` %in% val),]
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df = df[which(!df$`Transportation expense` %in% val),]
View(missing_val)
View(missing_val)
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
View(missing_val)
View(missing_val)
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df[which(!df$`Transportation expense` %in% val),] = NA
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
View(missing_val)
View(missing_val)
# Load train data
df =  read_excel("Absenteeism_at_work_Project.xls")
df1 = df
#All features/variables
var = colnames(df)
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
num_var = colnames(numeric_data)
#Categorical variables
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
#Check missing vales
sum(is.na(df$ID))
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
View(numeric_data)
View(numeric_data)
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
num_var = colnames(numeric_data)
#Categorical variables
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
#Check missing vales
sum(is.na(df$ID))
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
for(i in num_var){
print(i)
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df[which(!df$`Transportation expense` %in% val)] = NA
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df$`Transportation expense`[df$`Transportation expense` %in% val)] = NA
val = df$`Transportation expense`[df$`Transportation expense` %in% boxplot.stats(df$`Transportation expense`)$out]
df$`Transportation expense`[df$`Transportation expense` %in% val] = NA
View(missing_val)
View(missing_val)
df = knnImputation(df, k=3)
library(corrplot)
library(DMwR)
library(e1071)
library(caret)
library(class)
library(C50)
df = knnImputation(df, k=3)
df = knnImputation(df, k=3)
View(missing_val)
View(missing_val)
for(i in num_var)
{
boxplot(train_df[i])
}
for(i in num_var)
{
boxplot(df[i])
}
View(numeric_data)
View(numeric_data)
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
num_var = colnames(numeric_data)
#Categorical variables
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
nnames = colnames(numeric_data)
#Categorical variables
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cnames = colnames(category_data)
for(i in cnames)
{
boxplot(df[i])
}
#Numeric variables
numeric_data <- subset(df, select = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours'))
num_var = colnames(numeric_data)
#Categorical variables
category_data <- subset(df, select = c('Reason for absence','Day of the week','Seasons','Month of absence','Distance from Residence to Work','Work load Average/day','Education','Son','Pet','Disciplinary failure','Social drinker','Social smoker','Height','Weight','Body mass index'))
cat_var = colnames(category_data)
#Check missing vales
sum(is.na(df$ID))
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
for(i in num_var)
{
boxplot(df[i])
}
for(i in num_var)
{
boxplot(df[i])
}
df[]
df[,3]
for(i in num_var)
{
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
}
val = [df[,i] %in% boxplot.stats(df[,i])$out]
val = df[,i] %in% boxplot.stats(df[,i])$out
val = (df[,i] %in% boxplot.stats(df[,i])$out)
for(i in num_var)
{
val = (df[,i] %in% boxplot.stats(df[,i])$out)
}
val = (df[,i] %in% (boxplot.stats(df[,i])$out)))
for(i in num_var)
{
val = (df[,i] %in% (boxplot.stats(df[,i])$out)))
}
val = [df[,i] %in% (boxplot.stats(df[,i])$out)]
for(i in num_var)
{
val = [df[,i] %in% (boxplot.stats(df[,i])$out)]
}
val = df[,i] %in% (boxplot.stats(df[,i])$out)
View(missing_val)
View(missing_val)
val = df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)
for(i in num_var)
{
val = df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)
}
val = [df$`Month of absence`][df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)]
val = df$`Month of absence`[df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)]
df$`Month of absence`[df$`Month of absence` %in% val] = NA
{
val = df$`Month of absence`[df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)]
df$`Month of absence`[df$`Month of absence` %in% val] = NA
}
val = df$`Month of absence`[df$`Month of absence` %in% (boxplot.stats(df$`Month of absence`)$out)]
View(missing_val)
View(missing_val)
val
val
boxplot(df$`Month of absence`)
boxplot(df$`Transportation expense`)
boxplot(df$Age)
val = df$`Age`[df$`Age` %in% (boxplot.stats(df$`Age`)$out)]
df$`Age`[df$`Age` %in% val] = NA
val
View(missing_val)
View(missing_val)
missing_val = data.frame(apply(df, 2, function(x){sum(is.na(x))}))
View(missing_val)
View(missing_val)
df$Age = knnImputation(df$Age,k=3)
df$Age = knnImputation(df$Age,k=3)
df$Age = knnImputation(df$Age,k=2)
df$Age = knnImputation(df$Age,k=3)
for(i in num_var)
{
print(df$i)
}
x = c('ID','Transportation expense','Service time','Age','Hit target','Absenteeism time in hours')
for(i in x)
{
print(df$i)
}
print(x)
print(i)
for(i in length(x))
{
print(i)
}
for(i in x)
{
print(i)
}
print(df[,i])
for(i in x)
{
print(df[,i])
}
for(i in x)
{
val = df[,i][df[,i] %in% (boxplot.stats(df[,i])$out)]
df[,i][df[,i] %in% val] = NA
}
for(i in cat_var)
{
val = df[,i][df[,i] %in% (boxplot.stats(df[,i])$out)]
df[,i][df[,i] %in% val] = NA
}
for(i in cat_var){
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out)]
df[,i][df[,i] %in% val] = NA
}
for(i in cat_var){
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,i][df[,i] %in% val] = NA
}
#imputing missing values with NA
df = knnImputation(df, k = 3)
View(missing_val)
View(missing_val)
#use boxplot to remove replace outliers with NA
for(i in num_var){
val = df[,i][df[,i] %in% boxplot.stats(df[,i])$out]
df[,i][df[,i] %in% val] = NA
}
#imputing missing values with NA
df = knnImputation(df, k = 3)
